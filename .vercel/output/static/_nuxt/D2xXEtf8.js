import{ad as r,A as u}from"#entry";const s="change-me-now",i="admin_token",c=60;function l(n=32){const t=new Uint8Array(n);return crypto.getRandomValues(t),Array.from(t,o=>o.toString(16).padStart(2,"0")).join("")}function d(){const n=r(i,{sameSite:"lax",secure:!1,httpOnly:!1,maxAge:c*60}),t=u(()=>!!n.value);async function o(a){if(a!==s)throw new Error("Invalid password");return n.value=l(),!0}function e(){n.value=null}return{isAuthed:t,login:o,logout:e}}export{d as u};
